# 雪球投资论坛Chrome插件开发需求

## 📋 项目基本信息
- **插件名称**: 雪球消息监控助手
- **目标网站**: https://xueqiu.com/
- **运行环境**: Windows 10 + Chrome浏览器
- **开发语言**: JavaScript (Chrome Extension API)

## 🎯 核心功能需求

### 1. 监控功能
开发一款Chrome插件，实现对雪球投资论坛的实时消息监控：

#### 1.1 关注列表监控
- **监控目标**: 用户关注列表的新内容
- **触发条件**: 检测到关注列表有新发布的内容
- **监控频率**: 每3秒检查一次
- **去重机制**: 基于内容ID或时间戳避免重复通知

#### 1.2 系统消息监控  
- **监控目标**: "我的消息" → "系统消息" 菜单的消息数量变化
- **触发条件**: 检测到系统消息数量增加
- **监控频率**: 每3秒检查一次
- **数量显示**: 显示具体的未读消息数量

### 2. 通知系统

#### 2.1 通知形式
- **通知类型**: Windows 10 系统原生通知
- **通知持续时间**: 5秒（系统默认）
- **通知图标**: 插件自定义图标

#### 2.2 通知内容
- **关注列表新内容**: 
  - 标题: "雪球 - 关注列表更新"
  - 内容: 新内容的前20个字符 + "..."
- **系统消息**: 
  - 标题: "雪球 - 系统消息"
  - 内容: "您有 X 条新的系统消息"

#### 2.3 通知交互
- **点击行为**: 点击通知直接跳转到雪球对应页面
- **关闭行为**: 支持手动关闭通知

### 3. 设置管理

#### 3.1 开关控制
- **关注列表通知**: 默认开启，用户可关闭
- **系统消息通知**: 默认开启，用户可关闭
- **监控范围**: 后台持续监控（无需用户打开雪球页面）
- **重启行为**: 浏览器重启后开关状态重置为默认开启

#### 3.2 选项页面
- **访问方式**: 右键插件图标 → "选项"
- **界面要求**: 简洁易用的设置界面
- **实时生效**: 设置修改后立即生效，无需重启

### 4. 插件状态

#### 4.1 状态指示
- **图标状态**: 
  - 绿色: 正常监控中
  - 灰色: 监控已暂停
  - 红色: 连接异常
- **状态提示**: 鼠标悬停显示当前状态

#### 4.2 错误处理
- **网络异常**: 自动重试，最多3次
- **页面加载失败**: 显示错误状态，等待下次检查
- **权限不足**: 提示用户刷新页面或重新登录

## 🔧 技术规格

### 5.1 Chrome插件权限
```json
{
  "permissions": [
    "notifications",
    "storage",
    "activeTab",
    "background"
  ],
  "host_permissions": [
    "https://xueqiu.com/*"
  ]
}
```

### 5.2 数据存储
- **存储策略**: 不存储用户数据，仅在内存中临时保存去重信息
- **会话存储**: 
  - 当前会话的已读内容ID列表（用于去重）
  - 开关状态（浏览器重启后重置为默认开启）
  - 最后检查时间戳

### 5.3 监控机制
- **后台脚本**: 使用Service Worker进行定时检查
- **内容脚本**: 注入到雪球页面获取DOM信息
- **消息传递**: 后台脚本与内容脚本间的通信
<!-- - **页面切换**: 当浏览器从其他页面切换回雪球页面时，自动刷新页面 -->

## 🧪 开发测试配合

### 测试场景1: 关注列表新内容
**需要您配合的操作**:
1. 在雪球网站关注一些活跃用户
2. 等待或主动触发这些用户发布新内容
3. 观察页面上关注列表的UI变化
4. 帮助确定具体的DOM选择器和变化规律

### 测试场景2: 系统消息变化  
**需要您配合的操作**:
1. 在雪球进行一些可能触发系统消息的操作（如：点赞、评论、关注等）
2. 观察"我的消息"→"系统消息"菜单的数字变化
3. 帮助确定消息数量的DOM位置和更新机制

## ❓ 需要确认的技术细节

在开发过程中，我需要与您确认以下信息：

1. **页面元素定位**: 关注列表和系统消息在页面上的确切位置和CSS选择器
2. **登录状态检测**: 如何判断用户是否已登录雪球账号
3. **内容更新机制**: 雪球页面是否使用AJAX动态加载内容
4. **反爬虫机制**: 是否存在频率限制或其他反爬虫措施

## 📝 开发里程碑

1. **阶段1**: 基础插件框架搭建
2. **阶段2**: 页面元素识别和监控逻辑实现  
3. **阶段3**: 通知系统集成
4. **阶段4**: 设置页面开发
5. **阶段5**: 测试和优化

---

**请在后续开发过程中与我确认上述测试配合事项，以确保插件能够准确监控到页面变化。**
